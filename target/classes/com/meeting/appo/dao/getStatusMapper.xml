<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.meeting.appo.dao.EventStatusDao">


<!--    <select id="getStatusList"  resultType="com.meeting.appo.entities.Status">-->
<!--         select * from appo.tb_status where date(start_date)=#{day} order by start_date;-->
<!--    </select>-->

    <select id="getStatusList" resultMap="status_and_user">
         SELECT
         a.create_date create_date,
         a.start_date start_date,
         a.end_date end_date,
         a.participants participants,
         a.meeting_theme meeting_theme,
         a.status status,
         b.username username,
         b.mobile mobile,
         b.dept dept
         FROM tb_status a , tb_users b where
         a.uid=b.uid
         and DATE(a.start_date)=#{day}
         ORDER BY a.start_date
    </select>
    <resultMap id="status_and_user" type="com.meeting.appo.entities.Status">
        <result property="sid" column="sid" />
        <result property="create_date" column="create_date" />
        <result property="start_date" column="start_date" />
        <result property="end_date" column="end_date" />
        <result property="participants" column="participants" />
        <result property="meeting_theme" column="meeting_theme" />
        <result property="status" column="status" />
        <association property="user" javaType="com.meeting.appo.entities.User">
            <result property="uid" column="uid"/>
            <result property="username" column="username"/>
            <result property="mobile" column="mobile"/>
            <result property="dept" column="dept"/>
        </association>
    </resultMap>

</mapper>